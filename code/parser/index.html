


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.2.0">
    
    
      
        <title>parser.py - USC COVID Data Parser</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.18ac144a.min.css">
      
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#summary" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="USC COVID Data Parser" class="md-header-nav__button md-logo" aria-label="USC COVID Data Parser">
      
  <img src="../../images/covid-logo.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            USC COVID Data Parser
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              parser.py
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="USC COVID Data Parser" class="md-nav__button md-logo" aria-label="USC COVID Data Parser">
      
  <img src="../../images/covid-logo.png" alt="logo">

    </a>
    USC COVID Data Parser
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../data/" title="Data folder" class="md-nav__link">
      Data folder
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../docs/" title="Docs folder" class="md-nav__link">
      Docs folder
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../html/" title="HTML folder" class="md-nav__link">
      HTML folder
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5" checked>
    
    <label class="md-nav__link" for="nav-5">
      Src folder (code)
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Src folder (code)" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Src folder (code)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="parser.py" class="md-nav__link md-nav__link--active">
      parser.py
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../parse_building_directory/" title="parse_building_directory.py" class="md-nav__link">
      parse_building_directory.py
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../map_building_code_to_outline/" title="map_building_code_to_outline" class="md-nav__link">
      map_building_code_to_outline
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../constants/" title="constants.py" class="md-nav__link">
      constants.py
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../utils/" title="utils.py" class="md-nav__link">
      utils.py
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="summary"><strong>Summary</strong><a class="headerlink" href="#summary" title="Permanent link">&para;</a></h1>
<p>This project is designed to parse the raw html from the USC COVID data page and convert it in a more usable csv. The generated csv is then validated and any erronious rows are removed to guarantee the output file is consistant. The validation ensures that each column in the csv matches the pattern described in the column description below. For each row in the csv, any columns that cannot be parsed will be entered as <code>null</code> to prevent uneven rows. Rows with null values could be post-processed later if needed. </p>
<p>Since it is hard to do meaningful analysis on the data generated from covid data page alone, additional features have been added to enrich the output data. After the covid data page is parsed, an option to append building address to the end of the csv. This adds another two columns to each row of the csv with the full buiding name and street address. Since this process is automatic it is not perfect, any buildings who's address cannot be resolved will be entered as <code>null</code>. </p>
<p>The appended data is added from output csv (<code>building_code_map.csv</code>) of the <a href="../parse_building_directory">parse_building_directory.py</a> script. If this csv file doesnt exist, or if it is missconfigured then the parser will not be able to add the additional columns into the output csv file. </p>
<h1 id="setup"><strong>Setup</strong><a class="headerlink" href="#setup" title="Permanent link">&para;</a></h1>
<h3 id="downloading-the-covid-data"><strong>Downloading the covid data</strong><a class="headerlink" href="#downloading-the-covid-data" title="Permanent link">&para;</a></h3>
<p>The html parser reads in the raw html page from the USC COVID data site. Since the page requires users to be logged into the USC Shibboleth SSO (which additonally requires a confirmation from DUO Push) users are required to manually download the covid data page html. To do this simply navigate to the USC COVID data page and hit <code>ctrl + s</code> on the keyboard. Once downloaded the user will need to move it into the <code>/html</code> directory.  </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Because of the inconsistant way the covid data is entered onto the site, older data might not be correctly parsed in the current state of the parser. This parser was designed on the 2022 January/Febuary datasets.</p>
</div>
<h3 id="setting-up-the-building-code-map-csv-file-for-the-building-information-files"><strong>Setting up the building code map csv file for the building information files</strong><a class="headerlink" href="#setting-up-the-building-code-map-csv-file-for-the-building-information-files" title="Permanent link">&para;</a></h3>
<p>The <code>building_code_map.csv</code> should be included when you clone the repository. If needed, this file can be regenerated by following the steps in the <a href="../parse_building_directory">parse_building_directory.py</a> page. The building map csv file name is defined in the <code>src/constants.py</code> file. </p>
<h1 id="invocation"><strong>Invocation</strong><a class="headerlink" href="#invocation" title="Permanent link">&para;</a></h1>
<p>To run parser.py from the base project directory simply type: <code>python src/parser.py</code> into your terminal from the base project directory. </p>
<p><strong>Note:</strong> All directory references made within the file use relative paths, so it will not matter what directory the user calls this script from. </p>
<h1 id="output"><strong>Output</strong><a class="headerlink" href="#output" title="Permanent link">&para;</a></h1>
<h3 id="base-parsed-output"><strong>Base parsed output</strong><a class="headerlink" href="#base-parsed-output" title="Permanent link">&para;</a></h3>
<p>An example of an output csv is as follows:</p>
<div class="codehilite"><pre><span></span><code>class_name,code,weekday,start_time,end_time,location
AME-341B,28775,W,14:00,16:50,BHE301
AMST-101,10310,TH,09:30,10:50,MHP101
AMST-101,10312,F,11:00,11:50,GFS220
AMST-211,10300,MW,15:30,16:50,WPH207
...
</code></pre></div>


<p>The first line is always the header containing the name of each colomn. Below is a description of each colomn: </p>
<table>
<thead>
<tr>
<th>Column name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>class_name</td>
<td>Class name + code separated by hyphen</td>
</tr>
<tr>
<td>code</td>
<td>Internal USC class code. Contains only numbers.</td>
</tr>
<tr>
<td>weekday</td>
<td>Characters for day of week. Subset of "MTWTHF"</td>
</tr>
<tr>
<td>start_time</td>
<td>Starting time (24 hr). Format is <code>hour:min</code></td>
</tr>
<tr>
<td>end_time</td>
<td>Ending time (24 hr). Format is <code>hour:min</code></td>
</tr>
<tr>
<td>location</td>
<td>(building) location name and room number</td>
</tr>
</tbody>
</table>
<h3 id="building-information-appended"><strong>Building information appended</strong><a class="headerlink" href="#building-information-appended" title="Permanent link">&para;</a></h3>
<p>If the optional append building location selection is made the example output would be as follows: </p>
<div class="codehilite"><pre><span></span><code>class_name,code,weekday,start_time,end_time,location,full_building_name,building_address
AME-341B,28775,W,14:00,16:50,BHE301,Biegler Hall of Engineering,920 Downey Way
AMST-101,10310,TH,09:30,10:50,MHP101,Mudd Memorial Hall of Philosophy,3709 Trousdale Pkwy.
AMST-101,10312,F,11:00,11:50,GFS220,Grace Ford Salvatori Hall of Letters,Arts and Sciences 3601 Watt Way
AMST-211,10300,MW,15:30,16:50,WPH207,Waite Phillips Hall,3470 Trousdale Pkwy.
...
</code></pre></div>


<p>The two new collumns descriptions: </p>
<table>
<thead>
<tr>
<th>Column name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>full_building_name</td>
<td>Full name of building as presented on the USC building directory</td>
</tr>
<tr>
<td>building_address</td>
<td>Building address as presented on the USC building directory</td>
</tr>
</tbody>
</table>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../html/" title="HTML folder" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                HTML folder
              </div>
            </div>
          </a>
        
        
          <a href="../parse_building_directory/" title="parse_building_directory.py" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                parse_building_directory.py
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>